nginx:
  build: ./images/nginx
  ports:
    - "80:80"
  volumes_from:
    - app
  volumes:
    - "./config/nginx/conf.d:/etc/nginx/conf.d"
    - "./log/nginx:/var/log/nginx"
  links:
    - php


mysql:
  image: mariadb:latest
  volumes:
    - "./data/mysql:/var/lib/mysql"
  environment:
    MYSQL_ROOT_PASSWORD: secret
    MYSQL_DATABASE: app
    MYSQL_USER: app
    MYSQL_PASSWORD: app
  ports:
    - "3306:3306"

php:
  build: ./images/php
  volumes_from:
    - app
  volumes:
    - "./log/php:/var/log/"
  links:
    - mysql

composer:
  image: composer/composer
  volumes_from:
    - app
  command: "true"

app:
  image: php:7.0-fpm
  command: "true"
  volumes:
    - "../test_app/:/var/www/app/"

phpmyadmin:
  image: phpmyadmin/phpmyadmin
  links:
    - mysql
  ports:
    - "8080:80"
  environment:
   - PMA_HOST=mysql
   - PMA_USER=app
   - PMA_PASSWORD=app